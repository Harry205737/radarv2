<!DOCTYPE html>
<html>
<title>RADAR</title>
<body bgcolor=#fff style=margin:0;overflow:hidden>

<div style="position:relative;width:256px;height:256px;margin:auto;overflow:hidden;">
 <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:9;pointer-events:none;color:white;text-shadow:1px 1px 2px black;">+</div>
 
 <div id=V style="background:url('128melradar.jpg') no-repeat;background-size:256px 256px;width:256px;height:256px"></div>
 
 <div style="position:absolute;top:10px;right:10px;width:75px;border-bottom:2px solid #fff;text-align:right;font:10px sans-serif;color:white;text-shadow:1px 1px 2px black;">50km</div>
</div>

<div style="text-align:center;margin-top:8px;">
 <button onclick=c(-1)><</button>
 <button onclick="f(-37.86, 144.75)">REFRESH</button>
 <button onclick=c(1)>></button>
 <p id=M style="margin:5px 0 0 0;font-family:sans-serif;font-size:14px;">Loading...</p>
</div>

<script>
V=document.getElementById('V');M=document.getElementById('M');H=[];I=-1;

f=(y,x)=>{
 fetch('https://api.rainviewer.com/public/weather-maps.json').then(r=>r.json()).then(j=>{
  t=j.radar.past.at(-1).time;v=64;r=y*Math.PI/180;
  X=0|(x+180)/360*v;Y=0|(1-Math.log(Math.tan(r)+1/Math.cos(r))/Math.PI)/2*v;
  
  // Shift calculation: Adjusting the image position within the 256px container
  // to center the specific Lat/Lon coordinate.
  H.push({u:`${j.host}/v2/radar/${t}/256/6/${X}/${Y}/0/0_0.png`,s:new Date(t*1000).toLocaleTimeString()});
  I=H.length-1;d()
 }).catch(e=>M.innerText='!');
};

d=()=>{if(H[I]){
    // Added 'margin-left: -35px' to shift the tile left so Laverton is centered
    V.innerHTML=`<img src="${H[I].u}" width=256 height=256 style="display:block;opacity:0.7;margin-left:-35px;">`;
    M.innerText=H[I].s
}};

c=n=>{if(H[I+n]){I+=n;d()}};

// Initialize centered on Laverton
f(-37.86, 144.75);
</script>

</body>
</html>
