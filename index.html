<!DOCTYPE html>
<html>
<head>
    <title>Radar Lite</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; text-align: center; margin: 0; }
        #map-box { position: relative; width: 512px; height: 512px; margin: 10px auto; }
        /* Layer 1: Your JPG Map */
        #bg { position: absolute; top: 0; left: 0; width: 512px; height: 512px; z-index: 1; }
        /* Layer 2: The BoM Rain Overlay */
        #radar { position: absolute; top: 0; left: 0; width: 512px; height: 512px; z-index: 2; }
        .info { padding: 10px; font-size: 14px; }
    </style>
</head>
<body>

    <div class="info">
        <b>Laverton 128km</b><br>
        <span id="time">Loading...</span><br>
        <button onclick="refresh()">Manual Refresh</button>
    </div>

    <div id="map-box">
        <img id="bg" src="128melradar.jpg">
        <img id="radar" src="">
    </div>

    <script>
        function refresh() {
            const radarImg = document.getElementById('radar');
            const timeLabel = document.getElementById('time');
            
            // The magic URL: We use a CORS proxy to grab the static rain-only PNG
            // Adding ?v=... ensures we don't get a cached version
            const cacheBuster = Math.floor(Date.now() / 60000);
            const bomUrl = "http://reg.bom.gov.au/radar/IDR023.T.png?v=" + cacheBuster;
            
            // This proxy allows GitHub Pages to see the BoM image
            radarImg.src = "https://api.allorigins.win/raw?url=" + encodeURIComponent(bomUrl);

            radarImg.onload = () => {
                timeLabel.innerText = "Updated: " + new Date().toLocaleTimeString();
            };
            radarImg.onerror = () => {
                timeLabel.innerText = "Error loading. Try again.";
            };
        }

        // Run on start and then every 6 minutes (BoM updates every 6-10 mins)
        refresh();
        setInterval(refresh, 360000);
    </script>

</body>
</html>
