<!DOCTYPE html>
<html>
<head>
    <title>RADAR 256</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; text-align: center; margin: 0; padding: 5px; }
        /* Container and images locked to 256px */
        #map-box { position: relative; width: 256px; height: 256px; margin: 0 auto; overflow: hidden; background: #C4A484; }
        #bg { position: absolute; top: 0; left: 0; width: 256px; height: 256px; z-index: 1; }
        #radar { position: absolute; top: 0; left: 0; width: 256px; height: 256px; z-index: 2; opacity: 0.7; }
        .ui { margin: 10px 0; font-size: 12px; }
        button { padding: 5px 10px; background: #333; color: #fff; border: 1px solid #555; }
    </style>
</head>
<body>

    <div class="ui">
        <b>Laverton 128km</b><br>
        <span id="msg">...</span><br>
        <button onclick="f()">REFRESH</button>
    </div>

    <div id="map-box">
        <img id="bg" src="128melradar.jpg">
        <img id="radar">
    </div>

    <script>
        const M = document.getElementById('msg');
        const R = document.getElementById('radar');

        const f = () => {
            M.innerText = 'Loading...';
            fetch('https://api.rainviewer.com/public/weather-maps.json')
                .then(r => r.json())
                .then(j => {
                    const t = j.radar.past.at(-1).time;
                    // Zoom 6, X 56, Y 39 is the 256px tile for Laverton/Melbourne
                    const url = `${j.host}/v2/radar/${t}/256/6/56/39/1/1_1.png`;
                    R.src = url;
                    M.innerText = new Date(t * 1000).toLocaleTimeString();
                })
                .catch(() => { M.innerText = 'Error!'; });
        };

        f();
        setInterval(f, 300000); // 5 min refresh
    </script>
</body>
</html>
